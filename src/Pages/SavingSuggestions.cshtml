@page
@using System.Linq
@using ePiggyWeb.Utilities
@model ePiggyWeb.Pages.SavingSuggestionsModel

@if (Model.WasException)
{
    <div class="alert alert-danger" role="alert">
        Whoops! Something went wrong!
    </div>

}
<div class="row p-3 mb-5">
    <a class="btn btn-sm btn-outline-light" asp-page="/goals"><i class="fas fa-arrow-left"></i> Back to Goals</a>
</div>
<h2 class="text-light">@Model.Goal.Title</h2>
<h3 class="text-light mt-3 mb-4">Currently: @NumberFormatter.FormatCurrency(Model.Savings)/@NumberFormatter.FormatCurrency(Model.Goal.Amount)</h3>
<hr />
<br />

@if (!Model.WasException)
{
    <br />
    <hr />
    <form method="get" class="mt-5 mb-5">
        <input asp-for="Id" type="hidden" value="@Model.Id" />
        <input type="hidden" name="handler" value="Filter" />
        <label class="text-light">Period:</label>
        <input for="startDate" asp-for="StartDate" type="date" value="@Model.StartDate.ToShortDateString()" />
        <label class="text-light"> - </label>
        <input for="endDate" asp-for="EndDate" type="date" value="@Model.EndDate.ToShortDateString()" />
        <input type="submit" value="Filter" class="btn btn-warning ml-3" />
        <p class="text-warning">@Model.ErrorMessage</p>
    </form>
    <hr />

    <div class="container mb-5 " id="SavingType">
        <p>
            <label class="text-light">Saving type</label>
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#minimalSuggestions" aria-expanded="false" aria-controls="minimalSuggestions">
                Minimal
            </button>
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#regularSuggestions" aria-expanded="false" aria-controls="regularSuggestions">
                Regular
            </button>
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#maximalSuggestions" aria-expanded="false" aria-controls="maximalSuggestions">
                Maximal
            </button>
        </p>
        <!----------------------------MINIMAL----------------------------------------->
        <div class="collapse" id="minimalSuggestions" data-parent="#SavingType">
            <h4 class="text-light">Using suggestions you would need to save for <span class="text-warning">@Model.MinimalSuggestions.TimesToRepeatSaving months</span></h4>
            <!----------------------------PastedCode----------------------------------------->
            <div class="container">
                <h4 class="text-light mb-3">Suggested Expenses improvements (Minimal)</h4>
                <table class="table table-hover border-primary table-bordered mb-5">
                    <tr class="table-primary">
                        <th>
                            <label asp-for="MinimalSuggestions.EntrySuggestions.FirstOrDefault().Entry.Title"></label>
                        </th>
                        <th style="width: 15%">
                            <label asp-for="MinimalSuggestions.EntrySuggestions.FirstOrDefault().Entry.Date"></label>
                        </th>
                        <th style="width: 15%">
                            <label asp-for="MinimalSuggestions.EntrySuggestions.FirstOrDefault().Entry.Importance"></label>
                        </th>
                        <th style="width: 18%">
                            <label asp-for="MinimalSuggestions.EntrySuggestions.FirstOrDefault().Entry.Amount"></label>
                        </th>
                        <th style="width: 18%">
                            <label class="text-info"><b>Suggested Amount</b></label>
                        </th>

                    </tr>

                    @foreach (var item in Model.MinimalSuggestions.EntrySuggestions)
                    {
                        <tr class="table-light border-primary">
                            <td class="border-primary">
                                @Html.DisplayFor(m => item.Entry.Title)
                            </td>
                            <td class="border-primary">
                                @item.Entry.Date.ToShortDateString()
                            </td>
                            <td class="border-primary">
                                @((Importance) item.Entry.Importance)
                            </td>
                            <td class="border-primary">
                                @NumberFormatter.FormatCurrency(item.Entry.Amount)
                            </td>
                            <td class="border-primary text-info">
                                @NumberFormatter.FormatCurrency(item.Amount)
                            </td>
                        </tr>
                    }
                </table>
            </div>
            <hr />
            <div class="container">
                <h4 class="text-light mb-3">Suggested Expenses by category (Minimal)</h4>
                <table class="table table-hover border-primary table-bordered mt-5">
                    <tr class="table-primary">
                        <th>
                            <label asp-for="MinimalSuggestions.ImportanceSuggestions.FirstOrDefault().Importance"></label>
                        </th>
                        <th>
                            <label asp-for="MinimalSuggestions.ImportanceSuggestions.FirstOrDefault().OldAverage"></label>
                        </th>
                        <th>
                            <label class="text-info" asp-for="MinimalSuggestions.ImportanceSuggestions.FirstOrDefault().NewAverage"></label>
                        </th>
                    </tr>

                    @foreach (var item in Model.MinimalSuggestions.ImportanceSuggestions)
                    {
                        <tr class="table-light border-primary">
                            <td class="border-primary">
                                @Html.DisplayFor(m => item.Importance)
                            </td>
                            <td class="border-primary">
                                @NumberFormatter.FormatCurrency(item.OldAverage)
                            </td>
                            <td class="border-primary text-info">
                                @NumberFormatter.FormatCurrency(item.NewAverage)
                                <!--Html.DisplayFor(m => item.Date)-->
                            </td>
                        </tr>
                    }
                </table>
            </div>
            <hr />
            <!----------------------------PastedCode----------------------------------------->
        </div>
        <!----------------------------REGULAR----------------------------------------->
        <div class="collapse" id="regularSuggestions" data-parent="#SavingType">
            <h4 class="text-light">Using suggestions you would need to save for <span class="text-warning">@Model.RegularSuggestions.TimesToRepeatSaving months</span></h4>
            <!----------------------------PastedCode----------------------------------------->
            <div class="container">
                <h4 class="text-light mb-3">Suggested Expenses improvements (Regular)</h4>
                <table class="table table-hover border-primary table-bordered mb-5">
                    <tr class="table-primary">
                        <th>
                            <label asp-for="RegularSuggestions.EntrySuggestions.FirstOrDefault().Entry.Title"></label>
                        </th>
                        <th style="width: 15%">
                            <label asp-for="RegularSuggestions.EntrySuggestions.FirstOrDefault().Entry.Date"></label>
                        </th>
                        <th style="width: 15%">
                            <label asp-for="RegularSuggestions.EntrySuggestions.FirstOrDefault().Entry.Importance"></label>
                        </th>
                        <th style="width: 18%">
                            <label asp-for="RegularSuggestions.EntrySuggestions.FirstOrDefault().Entry.Amount"></label>
                        </th>
                        <th style="width: 18%">
                            <label class="text-info"><b>Suggested Amount</b></label>
                        </th>

                    </tr>

                    @foreach (var item in Model.RegularSuggestions.EntrySuggestions)
                    {
                        <tr class="table-light border-primary">
                            <td class="border-primary">
                                @Html.DisplayFor(m => item.Entry.Title)
                            </td>
                            <td class="border-primary">
                                @item.Entry.Date.ToShortDateString()
                            </td>
                            <td class="border-primary">
                                @((Importance) item.Entry.Importance)
                            </td>
                            <td class="border-primary">
                                @NumberFormatter.FormatCurrency(item.Entry.Amount)
                            </td>
                            <td class="border-primary text-info">
                                @NumberFormatter.FormatCurrency(item.Amount)
                            </td>
                        </tr>
                    }
                </table>
            </div>
            <hr/>
            <div class="container">
                <h4 class="text-light mb-3">Suggested Expenses by category (Regular)</h4>
                <table class="table table-hover border-primary table-bordered mt-5">
                    <tr class="table-primary">
                        <th>
                            <label asp-for="RegularSuggestions.ImportanceSuggestions.FirstOrDefault().Importance"></label>
                        </th>
                        <th>
                            <label asp-for="RegularSuggestions.ImportanceSuggestions.FirstOrDefault().OldAverage"></label>
                        </th>
                        <th>
                            <label class="text-info" asp-for="RegularSuggestions.ImportanceSuggestions.FirstOrDefault().NewAverage"></label>
                        </th>
                    </tr>

                    @foreach (var item in Model.RegularSuggestions.ImportanceSuggestions)
                    {
                        <tr class="table-light border-primary">
                            <td class="border-primary">
                                @Html.DisplayFor(m => item.Importance)
                            </td>
                            <td class="border-primary">
                                @NumberFormatter.FormatCurrency(item.OldAverage)
                            </td>
                            <td class="border-primary text-info">
                                @NumberFormatter.FormatCurrency(item.NewAverage)
                                <!--Html.DisplayFor(m => item.Date)-->
                            </td>
                        </tr>
                    }
                </table>
            </div>
            <hr/>
            <!----------------------------PastedCode----------------------------------------->
        </div>
        <!----------------------------MAXIMAL----------------------------------------->
        <div class="collapse" id="maximalSuggestions" data-parent="#SavingType">
            <h4 class="text-light">Using suggestions you would need to save for <span class="text-warning">@Model.MaximalSuggestions.TimesToRepeatSaving months</span></h4>
            <!----------------------------PastedCode----------------------------------------->
            <div class="container">
                <h4 class="text-light mb-3">Suggested Expenses improvements (Maximal)</h4>
                <table class="table table-hover border-primary table-bordered mb-5">
                    <tr class="table-primary">
                        <th>
                            <label asp-for="MaximalSuggestions.EntrySuggestions.FirstOrDefault().Entry.Title"></label>
                        </th>
                        <th style="width: 15%">
                            <label asp-for="MaximalSuggestions.EntrySuggestions.FirstOrDefault().Entry.Date"></label>
                        </th>
                        <th style="width: 15%">
                            <label asp-for="MaximalSuggestions.EntrySuggestions.FirstOrDefault().Entry.Importance"></label>
                        </th>
                        <th style="width: 18%">
                            <label asp-for="MaximalSuggestions.EntrySuggestions.FirstOrDefault().Entry.Amount"></label>
                        </th>
                        <th style="width: 18%">
                            <label class="text-info"><b>Suggested Amount</b></label>
                        </th>

                    </tr>

                    @foreach (var item in Model.MaximalSuggestions.EntrySuggestions)
                    {
                        <tr class="table-light border-primary">
                            <td class="border-primary">
                                @Html.DisplayFor(m => item.Entry.Title)
                            </td>
                            <td class="border-primary">
                                @item.Entry.Date.ToShortDateString()
                            </td>
                            <td class="border-primary">
                                @((Importance) item.Entry.Importance)
                            </td>
                            <td class="border-primary">
                                @NumberFormatter.FormatCurrency(item.Entry.Amount)
                            </td>
                            <td class="border-primary text-info">
                                @NumberFormatter.FormatCurrency(item.Amount)
                            </td>
                        </tr>
                    }
                </table>
            </div>
            <hr/>
            <div class="container">
                <h4 class="text-light mb-3">Suggested Expenses by category (Maximal)</h4>
                <table class="table table-hover border-primary table-bordered mt-5">
                    <tr class="table-primary">
                        <th>
                            <label asp-for="MaximalSuggestions.ImportanceSuggestions.FirstOrDefault().Importance"></label>
                        </th>
                        <th>
                            <label asp-for="MaximalSuggestions.ImportanceSuggestions.FirstOrDefault().OldAverage"></label>
                        </th>
                        <th>
                            <label class="text-info" asp-for="MaximalSuggestions.ImportanceSuggestions.FirstOrDefault().NewAverage"></label>
                        </th>
                    </tr>

                    @foreach (var item in Model.MaximalSuggestions.ImportanceSuggestions)
                    {
                        <tr class="table-light border-primary">
                            <td class="border-primary">
                                @Html.DisplayFor(m => item.Importance)
                            </td>
                            <td class="border-primary">
                                @NumberFormatter.FormatCurrency(item.OldAverage)
                            </td>
                            <td class="border-primary text-info">
                                @NumberFormatter.FormatCurrency(item.NewAverage)
                                <!--Html.DisplayFor(m => item.Date)-->
                            </td>
                        </tr>
                    }
                </table>
            </div>
            <hr/>
            <!----------------------------PastedCode----------------------------------------->
        </div>
    </div>

    
}
else
{
    <br/><br /><br /><br/><br/><br /><br /> <br/><br/><br/>
}

